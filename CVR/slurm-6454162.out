## SLURM PROLOG ###############################################################
##    Job ID : 6454162
##  Job Name : CS-L0_0_4stage+mlp
##  Nodelist : gpu2115
##      CPUs : 1
##  Mem/Node : 32768 MB
## Directory : /gpfs/data/epavlick/mlepori/projects/Compositional_Subnetworks/CVR
##   Job Started : Thu Oct 27 19:02:47 EDT 2022
###############################################################################
module: loading 'python/3.7.4'
module: loading 'gcc/10.2'
module: gcc: "Note: loading the gcc module overrides the gcc version on the system.  If you want to revert to the version of gcc provided by the OS, unload the gcc module."
module: loading 'cuda/11.1.1'
module: cuda: To use: module load gcc/10.2
module: loading 'cudnn/8.2.0'
module: cudnn: To use: module load cuda/11.1.1 gcc/10.2
/users/mlepori/.local/lib/python3.7/site-packages/pytorch_lightning/utilities/seed.py:66: UserWarning: -1 is not in bounds, numpy accepts from 0 to 4294967295
  rank_zero_warn(f"{seed} is not in bounds, numpy accepts from {min_seed_value} to {max_seed_value}")
Global seed set to 1656494904
Multiprocessing is handled by SLURM.
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Missing logger folder: /gpfs/data/epavlick/mlepori/projects/Compositional_Subnetworks/Models/resnet50/Param_Sweep/Inside/L0_0_stage4+mlp_test/lightning_logs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/users/mlepori/.local/lib/python3.7/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:245: PossibleUserWarning: The dataloader, test_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 48 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  category=PossibleUserWarning,
27774
stage4
Constructing L0 MLP...
Loading MLP weights...
Freezing MLP weights...
Freezing MLP mask weights...
"ablation_strategies":               ['zero', 'random']
"accelerator":                       None
"accumulate_grad_batches":           None
"amp_backend":                       native
"amp_level":                         None
"auto_lr_find":                      False
"auto_scale_batch_size":             False
"auto_select_gpus":                  False
"backbone":                          L0resnet50
"batch_size":                        64
"benchmark":                         None
"check_val_every_n_epoch":           1
"checkpoint_callback":               None
"config":                            /gpfs/data/epavlick/mlepori/projects/Compositional_Subnetworks/CVR/configs/CompositionalSubnetworks/RN50_Param_Search/Inside_Subnetwork/Test/L0_0_4stage+mlp.yaml
"data_dir":                          /users/mlepori/data/mlepori/projects/Compositional_Subnetworks/Data/
"dataset":                           CVRTDataModule
"default_root_dir":                  None
"detect_anomaly":                    False
"deterministic":                     False
"devices":                           None
"enable_checkpointing":              True
"enable_model_summary":              True
"enable_progress_bar":               True
"eval_only":                         True
"exp_dir":                           /gpfs/data/epavlick/mlepori/projects/Compositional_Subnetworks/Models/resnet50/Param_Sweep/Inside/L0_0_stage4+mlp_test
"exp_name":                          L0_0_stage4+mlp_test
"fast_dev_run":                      False
"flush_logs_every_n_steps":          None
"gpus":                              1
"gradient_clip_algorithm":           None
"gradient_clip_val":                 None
"ipus":                              None
"l0_components":                     {'backbone': True, 'mlp': True}
"l0_init":                           -0.1
"l0_lambda":                         1e-08
"l0_stages":                         ['stage_4']
"limit_predict_batches":             None
"limit_test_batches":                None
"limit_train_batches":               None
"limit_val_batches":                 None
"log_every_n_steps":                 50
"log_gpu_memory":                    None
"logger":                            True
"lr":                                0.0001
"max_epochs":                        120
"max_steps":                         -1
"max_temp":                          300
"max_time":                          None
"min_epochs":                        None
"min_steps":                         None
"mlp_dim":                           128
"mlp_hidden_dim":                    256
"model":                             CNN
"move_metrics_to_cpu":               False
"multiple_trainloader_mode":         max_size_cycle
"n_samples":                         10000
"n_tasks":                           0
"num_nodes":                         1
"num_processes":                     None
"num_sanity_val_steps":              2
"num_workers":                       1
"overfit_batches":                   0.0
"path_db":                           /gpfs/data/epavlick/mlepori/projects/Compositional_Subnetworks/Models/resnet50/Param_Sweep/Inside
"plugins":                           None
"precision":                         32
"prepare_data_per_node":             None
"pretrained_weights":                {'backbone': '/gpfs/data/epavlick/mlepori/projects/Compositional_Subnetworks/Models/resnet50/Param_Sweep/Inside/L0_0_stage4+mlp/backbone.pt', 'mlp': '/gpfs/data/epavlick/mlepori/projects/Compositional_Subnetworks/Models/resnet50/Param_Sweep/Inside/L0_0_stage4+mlp/mlp.pt', 'embedding': False}
"process_position":                  0
"profiler":                          None
"progress_bar_refresh_rate":         None
"reload_dataloaders_every_n_epochs": 0
"replace_sampler_ddp":               True
"resume_from_checkpoint":            None
"seed":                              -1
"ssl_pretrain":                      False
"stochastic_weight_avg":             False
"strategy":                          None
"sync_batchnorm":                    False
"task":                              0
"task_embedding":                    0
"tasks":                             ['108', '109']
"terminate_on_nan":                  None
"test_set":                          
"test_transform":                    
"tpu_cores":                         None
"track_grad_norm":                   -1
"train_masks":                       {'backbone': False, 'mlp': False}
"train_transform":                   None
"train_weights":                     {'backbone': False, 'mlp': False, 'embedding': False}
"val_check_interval":                None
"val_transform":                     None
"wd":                                0.0001
"weights_save_path":                 None
"weights_summary":                   top
Testing: 0it [00:00, ?it/s]Traceback (most recent call last):
  File "/gpfs/data/epavlick/mlepori/projects/Compositional_Subnetworks/CVR/test.py", line 109, in <module>
    cli_main()
  File "/gpfs/data/epavlick/mlepori/projects/Compositional_Subnetworks/CVR/test.py", line 73, in cli_main
    trainer.test(model=model, datamodule=datamodule)
  File "/users/mlepori/.local/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py", line 939, in test
    return self._call_and_handle_interrupt(self._test_impl, model, dataloaders, ckpt_path, verbose, datamodule)
  File "/users/mlepori/.local/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py", line 724, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/users/mlepori/.local/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py", line 986, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/users/mlepori/.local/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py", line 1237, in _run
    results = self._run_stage()
  File "/users/mlepori/.local/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py", line 1321, in _run_stage
    return self._run_evaluate()
  File "/users/mlepori/.local/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py", line 1366, in _run_evaluate
    eval_loop_results = self._evaluation_loop.run()
  File "/users/mlepori/.local/lib/python3.7/site-packages/pytorch_lightning/loops/base.py", line 204, in run
    self.advance(*args, **kwargs)
  File "/users/mlepori/.local/lib/python3.7/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 153, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/users/mlepori/.local/lib/python3.7/site-packages/pytorch_lightning/loops/base.py", line 204, in run
    self.advance(*args, **kwargs)
  File "/users/mlepori/.local/lib/python3.7/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 111, in advance
    batch = next(data_fetcher)
  File "/users/mlepori/.local/lib/python3.7/site-packages/pytorch_lightning/utilities/fetching.py", line 184, in __next__
    return self.fetching_function()
  File "/users/mlepori/.local/lib/python3.7/site-packages/pytorch_lightning/utilities/fetching.py", line 259, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "/users/mlepori/.local/lib/python3.7/site-packages/pytorch_lightning/utilities/fetching.py", line 273, in _fetch_next_batch
    batch = next(iterator)
  File "/users/mlepori/.local/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/users/mlepori/.local/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 1199, in _next_data
    return self._process_data(data)
  File "/users/mlepori/.local/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 1225, in _process_data
    data.reraise()
  File "/users/mlepori/.local/lib/python3.7/site-packages/torch/_utils.py", line 429, in reraise
    raise self.exc_type(msg)
FileNotFoundError: Caught FileNotFoundError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/users/mlepori/.local/lib/python3.7/site-packages/torch/utils/data/_utils/worker.py", line 202, in _worker_loop
    data = fetcher.fetch(index)
  File "/users/mlepori/.local/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/users/mlepori/.local/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/gpfs/data/epavlick/mlepori/projects/Compositional_Subnetworks/CVR/datasets/cvrt.py", line 230, in __getitem__
    sample = Image.open(sample_path)
  File "/users/mlepori/.local/lib/python3.7/site-packages/PIL/Image.py", line 2953, in open
    fp = builtins.open(filename, "rb")
FileNotFoundError: [Errno 2] No such file or directory: '/users/mlepori/data/mlepori/projects/Compositional_Subnetworks/Data/task_shape/test/00000.png'

Testing: 0it [00:00, ?it/s]
